FluTrain <- read.csv('FluTrain.csv')
FluTrain <- read.csv('FluTrain.csv')
FluTest <- read.csv('FluTest.csv')
pisaTest <- read.csv('pisa2009test.csv')
pisaTrain <- read.csv('pisa2009train.csv')
setwd("D:\zhivko\linear_regression")
# set the working directory
setwd("D:/zhivko/linear_regression")
getwd()
list.files("dataSets")
states.data <- readRDS
states.info <- data.frame(attributes(states.data)[c("names", "var.labels")])
tail(states.info, 8)
sts.ex.sat <- subset(states.data, select = c("expense", "csat"))
##   Start by examining the data to check for problems.
# summary of expense and csat columns, all rows
sts.ex.sat <- subset(states.data, select = c("expense", "csat"))
summary(sts.ex.sat)
# correlation between expense and csat
cor(sts.ex.sat)
states.data <- readRDS("dataSets/states.rds")
states.info <- data.frame(attributes(states.data)[c("names", "var.labels")])
tail(states.info, 8)
sts.ex.sat <- subset(states.data, select = c("expense", "csat"))
sts.ex.sat <- subset(states.data, select = c("expense", "csat"))
summary(sts.ex.sat)
cor(sts.ex.sat)
plot(sts.ex.sat)
sat.mod <- lm(csat ~ expense, # regression formula
data=states.data) # data set
# Summarize and print the results
summary(sat.mod) # show regression coefficients table
summary(lm(csat ~ expense + percent, data = states.data))
class(sat.mod)
names(sat.mod)
methods(class = class(sat.mod))[1:9]
confint(sat.mod)
par(mar = c(4, 4, 2, 2), mfrow = c(1, 2)) #optional
plot(sat.mod, which = c(1, 2)) # "which" argument optional
sat.voting.mod <-  lm(csat ~ expense + house + senate,
data = na.omit(states.data))
sat.mod <- update(sat.mod, data=na.omit(states.data))
# compare using the anova() function
anova(sat.mod, sat.voting.mod)
coef(summary(sat.voting.mod))
View(states.info)
View(states.data)
View(sts.ex.sat)
cor(states.data$energy, states.data$metro)
cor(sts.ex.sat)
cor(sts.ex.sat$expense, sts.ex.sat$csat)
cor(states.data$energy, states.data$metro)
View(states.data)
View(states.data)
states.data$energy
states.data$metro
cor(states.data$energy, states.data$metro)
sts.ex.sat$expense
dplyr::
library(dplyr)
Exercise1Data <- filter(states.data, energy !is.na())
Exercise1Data <- filter(states.data, !is.na(energy))
Exercise1Data <- filter(states.data, !is.na(energy, metro))
Exercise1Data <- filter(states.data, !is.na(energy) !is.na(metro))
Exercise1Data <- filter(states.data, !is.na(energy) and !is.na(metro))
Exercise1Data <- filter(states.data, !is.na(energy), !is.na(metro))
Exercise1Data <- filter(states.data, !is.na(energy) & !is.na(metro))
cor(Exercise1Data$energy, Exercise1Data$metro)
plot(Exercise1Data$energy, Exercise1Data$metro)
hist(Exercise1Data$energy)
hist(Exercise1Data$metro)
hist(Exercise1Data$energy)
plot(log(Exercise1Data$energy), Exercise1Data$metro)
plot(Exercise1Data$energy, Exercise1Data$metro)
EnergyModel1 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$metro)
summary(EnergyModel1)
cor(Exercise1Data$energy, .)
cor(Exercise1Data)
View(Exercise1Data)
View(states.info)
Exercise1Data %>% select(which(sapply(., is.numeric)))
Exercise1Correlations <- Exercise1Data %>% select(which(sapply(., is.numeric)))
Exercise1Correlations <- Exercise1Data %>% select(which(sapply(., is.numeric))) %>% na.omit()
cor(Exercise1Correlations)
cor(Exercise1Correlations)$energy
cor(Exercise1Correlations)[1]
test <- cor(Exercise1Correlations)
View(test)
test$energy
test[4]
View(test)
test[,"energy"]
hist(test[,"energy"])
plot(test[,"energy"])
EnergyModel2 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$metro + Exercise1Data$miles +Exercise1Data$toxics + Exercise1Data$green + Exercise1Data$house + Exercise1Data$income)
summary(EnergyModel2)
EnergyModel2 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$metro + Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$house + Exercise1Data$income)
summary(EnergyModel2)
View(test)
cor(Exercise1Data$metro, Exercise1Data$miles,Exercise1Data$toxic, Exercise1Data$green, Exercise1Data$house, Exercise1Data$income)
cor(Exercise1Data$metro, Exercise1Data$miles, Exercise1Data$toxic, Exercise1Data$green, Exercise1Data$house, Exercise1Data$income)
cor(Exercise1Data$metro Exercise1Data$miles Exercise1Data$toxic Exercise1Data$green Exercise1Data$house Exercise1Data$income)
cor(Exercise1Data[1:3])
cor(Exercise1Data[3:5])
cor(Exercise1Data[3,5,7])
independentCorrelation <- test %>% select(contains("metro"))
independentCorrelation <- test %>% select("metro")
independentCorrelation <- test %>% select(matches('metro'))
independentCorrelation <- test %>% select(matches('metro|miles'))
View(test)
independentCorrelation <- test %>% select(matches("^(energy|metro)_"))
independentCorrelation <- test %>% select(everything())
independentCorrelation <- Exercise1Correlations %>% select(matches('metro|miles'))
View(independentCorrelation)
View(independentCorrelation)
independentCorrelation <- Exercise1Correlations %>% select(matches('metro|miles|toxic|green|house|income'))
cor(independentCorrelation)
EnergyModel3 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$metro + Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$house)
summary(EnergyModel3)
EnergyModel4 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$house)
summary(EnergyModel4)
EnergyModel5 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green)
summary(EnergyModel5)
EnergyModel5 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$metro +Exercise1Data$toxic + Exercise1Data$green)
summary(EnergyModel5)
EnergyModel6 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$toxic + Exercise1Data$green)
summary(EnergyModel6)
EnergyModel5 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green)
summary(EnergyModel5)
sat.expense.by.percent <- lm(csat ~ expense*income,
data=states.data)
coef(summary(sat.expense.by.percent))
str(states.data$region)
states.data$region <- factor(states.data$region)
sat.region <- lm(csat ~ region,
data=states.data)
coef(summary(sat.region))
anova(sat.region)
View(states.info)
EnergyModel5 <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green)
summary(EnergyModel5)
InteractionModel <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$area/Exercise1Data$density)
summary(InteractionModel)
InteractionModel <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$area*Exercise1Data$density)
summary(InteractionModel)
sat.region <- lm(csat ~ region,
data=states.data)
summary(sat.region)
summary(sat.expense.by.percent)
InteractionModel <- lm(log(Exercise1Data$energy) ~ Exercise1Data$miles +Exercise1Data$toxic + Exercise1Data$green + Exercise1Data$area/Exercise1Data$density)
summary(InteractionModel)
contrasts(states.data$region)
RegionModel <- lm(log(energy) ~ miles +toxic + green + C(region, contr.helmert), data=states.data)
summary(RegionModel)
